"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{75999:function(e,n,t){t.d(n,{Z:function(){return m}});var r=t(14924),c=t(85893),o=(t(67294),t(58067)),i=t(68940),a=t(76867),s=t(79571),l=t(24242),u=t(71217);function d(e){var n=e.className;return(0,c.jsxs)("div",{className:n,children:["Welcome to the Elumicate Mining Portal!",(0,c.jsx)("br",{}),"Please login and connect to Metamask to access the site."]})}var h="@media (max-width: 755px)",f=(0,o.k)((function(e){return{wrapper:{position:"relative",boxSizing:"border-box",backgroundColor:"dark"===e.colorScheme?e.colors.dark[8]:"#ffffffdb",boxShadow:"dark"===e.colorScheme?"0px 0px 6px 6px #00000030":"0px 0px 6px 6px #ffffffdb"},inner:{position:"relative",paddingLeft:0,paddingRight:0,maxWidth:"none"},title:(0,r.Z)({fontFamily:"Proxima-Nova, ".concat(e.fontFamily),fontSize:62,fontWeight:900,lineHeight:1.1,margin:0,padding:0,color:"dark"===e.colorScheme?e.white:e.black},h,{fontSize:42,lineHeight:1.2}),description:(0,r.Z)({marginTop:e.spacing.xl,fontSize:24},h,{fontSize:18}),controls:(0,r.Z)({marginTop:2*e.spacing.xl},h,{marginTop:e.spacing.xl}),control:(0,r.Z)({height:54,paddingLeft:38,paddingRight:38},h,{height:54,paddingLeft:18,paddingRight:18,flex:1}),githubControl:{borderWidth:2,borderColor:"dark"===e.colorScheme?"transparent":e.colors.dark[9],backgroundColor:"dark"===e.colorScheme?e.colors.dark[5]:"transparent","&:hover":{backgroundColor:"".concat("dark"===e.colorScheme?e.colors.dark[6]:e.colors.gray[0]," !important")}},paddingLeft:{paddingLeft:"36px"},loginMsgDiv:{width:"100%",height:"100%",fontSize:"2em",fontWeight:"bold",textAlign:"center"}}})),g=(i.O,(0,u.Pi)((function(e){var n=e.children,t=f().classes,r=(0,l.o)().god,o=((0,u.fv)((function(){return{showConnecter:function(){r.setShowConnecter(!0)},showWalletInfo:function(){r.currentNetwork.walletInfo.visible=!0},currentAvatar:1}})),(0,c.jsx)(u.Qj,{children:function(){return(0,c.jsx)(s.C,{children:(0,c.jsx)("div",{className:t.wrapper,children:(0,c.jsx)(a.W,{className:t.inner,children:r.currentNetwork.account?n:(0,c.jsx)(d,{className:t.loginMsgDiv})})})})}}));return(0,c.jsx)(c.Fragment,{children:o})})));g.displayName="HeroTitle";var m=g},56894:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var r=t(47568),c=t(34051),o=t.n(c),i=t(85893),a=t(75999),s=t(58067),l=t(91142),u=t(88852),d=t(55910),h=t(33331),f=t(24242),g=t(9669),m=t.n(g),p=t(86455),x=t.n(p),N=t(31037),b=t(59411),j=t(67294),k=t(1686),v=t(71217),w=t(55649),S=t(94184),C=t.n(S),T=t(44868),E=h.m.BACKEND_URL,_=(0,s.k)((function(e){return{NFTTable:{background:"white",color:"black",width:"100%"},thead:{borderBottom:"1px solid black"},orange:{backgroundColor:"rgb(255, 102, 0)"},th:{borderBottom:"1px solid black"},center:{textAlign:"center"},green:{color:"green"}}})),F=(0,v.Pi)((function(e){var n=_().classes,t=(0,f.o)(),r=t.auth,c=(t.god,(0,j.useState)(0)),o=c[0],a=c[1],s=(0,j.useState)(0),l=s[0],u=s[1],d=(0,j.useState)(0),h=d[0],g=d[1],m=(0,j.useState)("0"),p=m[0],x=m[1];return(0,j.useEffect)((function(){r.$().get("".concat(E,"/api/epoch/status")).then((function(e){var n=e.data;a(n.data.duration),u(n.data.miner),g(n.data.weight),console.log("getInformation",n),x((0,T.SF)(BigInt(n.data.reward)).toString())})).catch((function(e){a(0),u(0),g(0),x("0"),console.log("getInformation error",e)}))}),[]),(0,i.jsx)(k.Z,{label:"Overall Network Stats",headerClass:n.orange,children:(0,i.jsxs)("table",{className:n.NFTTable,children:[(0,i.jsx)("thead",{className:n.thead,children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:n.th,children:"Epoch Duration"},"1"),(0,i.jsx)("th",{className:n.th,children:"Active Miners"},"2"),(0,i.jsx)("th",{className:n.th,children:"Accumulated Weight Rating"},"3"),(0,i.jsx)("th",{className:n.th,children:"Epoch Rewards"},"4")]})}),(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:C()(n.center,n.green),children:[o," Seconds"]},"1"),(0,i.jsx)("td",{className:n.center,children:l},"2"),(0,i.jsx)("td",{className:n.center,children:h},"3"),(0,i.jsxs)("td",{className:n.center,children:[p," ELUM"]},"4")]})})]})})})),y=(0,s.k)((function(e){return{NFTTable:{background:"white",color:"black",width:"100%"},thead:{borderBottom:"1px solid black"},orange:{backgroundColor:"rgb(255, 102, 0)"},th:{borderBottom:"1px solid black"},center:{textAlign:"center"},green:{color:"green"},centerAlign:{display:"flex",alignItems:"center",justifyContent:"center",height:"36px"},imgStyle:{height:30,transform:"translate(0px, 2px)"},minerName:{position:"absolute",top:3,paddingRight:5,backgroundColor:"black",left:8,display:"flex",alignItems:"center",justifyContent:"center"}}})),M=(0,v.Pi)((function(e){var n=y().classes;return(0,i.jsx)(k.Z,{label:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:n.centerAlign,children:(0,i.jsx)("span",{children:"Historical Rewards"})}),(0,i.jsxs)("div",{className:n.minerName,children:[(0,i.jsx)("img",{src:"/images/status/working.png",className:n.imgStyle}),e.nft_id]})]}),children:(0,i.jsxs)("table",{className:n.NFTTable,children:[(0,i.jsx)("thead",{className:n.thead,children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:n.th,children:"Epoch Time"},"1"),(0,i.jsx)("th",{className:n.th,children:"Mining Time"},"2"),(0,i.jsx)("th",{className:n.th,children:"Multiplier"},"3"),(0,i.jsx)("th",{className:n.th,children:"Epoch Reward"},"4")]})}),(0,i.jsx)("tbody",{children:e.info.map((function(e,t){return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:C()(n.center,n.green),children:(0,T.t3)(e.epoch)},"1"),(0,i.jsxs)("td",{className:n.center,children:[e.uptime," seconds"]},"2"),(0,i.jsxs)("td",{className:n.center,children:["X ",e.multiplier/1e4]},"3"),(0,i.jsxs)("td",{className:n.center,children:[null==e.reward?0:(0,T.SF)(BigInt(e.reward))," ELUM"]},"4")]},t)}))})]})})})),I=h.m.BACKEND_URL,L=(0,s.k)((function(e){return{}})),R=(0,v.Pi)((function(e){L().classes;var n=(0,f.o)(),t=n.god,r=n.auth,c=(0,j.useState)([]),o=c[0],a=c[1];return(0,j.useEffect)((function(){r.$().post("".concat(I,"/api/device_uptime/getUpTimeInfo"),{address:t.currentNetwork.account}).then((function(e){console.log("miner response",e);var n=e.data.data,t={};n.forEach((function(e){null==t[e.nft_id]&&(t[e.nft_id]=[]),t[e.nft_id].push(e)})),a(Object.keys(t).map((function(e){return{nft_id:e,info:t[e].sort((function(e,n){return n.epoch-e.epoch}))}})))})).catch((function(e){console.error(e)}))}),[t.currentNetwork.account]),(0,i.jsx)(i.Fragment,{children:o.map((function(e){return(0,i.jsx)(M,{nft_id:e.nft_id,info:e.info})}))})})),B=(t(18699).getWindow().ethereum,h.m.BACKEND_URL),A=(0,s.k)((function(e){return{progressBar:{"&:not(:first-of-type)":{borderLeft:"3px solid ".concat("dark"===e.colorScheme?e.colors.dark[7]:e.white)}},NFTTable:{background:"white",color:"black",width:"100%"},green:{color:"green"},center:{textAlign:"center"},button:{marginLeft:10,marginRight:10},thead:{borderBottom:"1px solid black"},th:{borderBottom:"1px solid black"},btn_th:{width:110}}})),D=(0,v.Pi)((function(){var e=A().classes,n=(0,f.o)(),t=n.god,c=n.auth,s=n.nft,g=(0,j.useState)(!1),p=g[0],v=g[1],S=(0,j.useState)([]),C=(S[0],S[1]),T=(0,j.useState)([]),E=T[0],_=T[1],y=(0,j.useState)(""),M=y[0],I=y[1],L=(0,j.useState)(null),D=L[0],Z=L[1];(0,j.useEffect)((function(){s.refresh()}),[t.currentNetwork.account]);var P=function(){var e="".concat(h.m.DEVICE_URL,"/get_status");m().get(e).then((function(e){var n=e.data;"an error has occured"==n.message?I(""):c.$().post("".concat(B,"/api/nft_auth/verifySignature"),{signature:n.signature}).then((function(e){"OK"===e.data.status?I(""):I(n.miner)})).catch((function(e){I(n.miner)}))})).catch((function(e){I("")}))},z=function(){s.getNFTLists().then(function(){var e=(0,r.Z)(o().mark((function e(n){var t,r,i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n,r=[],i=0;case 3:if(!(i<t.length)){e.next=19;break}return a=t[i].toString(),e.prev=5,e.next=8,c.$().post("".concat(B,"/api/nft_auth/status"),{nft_id:a});case 8:s=e.sent,l=s.data.data,r.push({NFT:l.nft_id,Miner:l.miner?l.miner:"Not set",Connection:l.session?"Assigned":"Not assigned"}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),r.push({NFT:parseInt(a),Miner:"Not assigned",Connection:"Not assigned"});case 16:i++,e.next=3;break;case 19:_(r);case 20:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){C([])}))},O=function(){z(),P()};(0,j.useEffect)((function(){P()}),[t.currentNetwork.account]),(0,j.useEffect)((function(){var e=setInterval((function(){P()}),2e3);return function(){clearInterval(e)}}),[]),(0,j.useEffect)((function(){z()}),[t.currentNetwork.account]);var W=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.Kt,e.prev=1,e.next=4,t.currentNetwork.execContract({address:n,abi:N.Mt,method:"balanceOf",params:[t.currentNetwork.account]});case 4:if(!(e.sent[0]>0)){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();(0,j.useEffect)((function(){W().then((function(e){v(!0)})).catch((function(e){v(!1)}))}),[t.currentNetwork.account]);return s.loading?(0,i.jsx)(a.Z,{children:(0,i.jsx)(l.a,{})}):(0,i.jsxs)(a.Z,{children:[(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)(w.Ph,{placeholder:s.infoList.length>0?"Choose NFT to ":"No NFTs to assign",data:E.filter((function(e){return"Not assigned"==e.Connection})).map((function(e,n){return{value:e.NFT.toString(),label:"NFT "+e.NFT.toString(),group:"Testnet Miner"}})),style:{marginRight:10},onChange:Z}),(0,i.jsx)(u.z,{style:{marginBottom:"10px"},onClick:function(){if(!1!==p)if(null!=D){var e=function(){c.$().post("".concat(B,"/api/nft_auth/create"),{address:t.currentNetwork.account,nft_id:D,miner:M}).then((function(e){if("success"==e.data.status){x().fire({title:"Success",html:"<p>Secure Miner Connection Success</p>",icon:"success"}),O();var n="".concat(h.m.DEVICE_URL,"/set_signature"),r=t.currentNetwork.account,c=D,o=e.data.camera.link,i="P"+(e.data.camera.tableid+1)+e.data.camera.id;m().post(n,{signature:e.data.session,nftID:c,wallet:r,link:o,location_id:i},{})}else x().fire({title:"Error",html:"<p>No assignable miners</p>",icon:"error"})})).catch((function(e){x().fire({title:"Error",html:"<p>Errors occured while securing miner connection</p>",icon:"error"})}))};c.check_auth((function(){e()}),(function(){x().fire({title:"Error",html:"<p>You need to login to secure miner connection.</p>",icon:"error",showCancelButton:!0}).then((function(n){n.isConfirmed&&c.login((function(){e()}),(function(){x().fire({title:"Error",html:"<p>Errors Occured while login.</p>",icon:"error"})}))})).catch((function(){x().fire({title:"Info",html:"<p>Securing Miner Connection has been failed.</p>",icon:"info"})}))}))}else x().fire("Info","<p>You need to choose an NFT to secure your Mining Connection.</p>","info");else x().fire("Error",'<p>You do not have an NFT to secure your Mining Connection.</p>\n                 <p>Please obtain a mining NFT and try again.</p>\n                 <p><a href="/nft/">Buy NFT</a></p>',"warning")},rightIcon:(0,i.jsx)(d.Z,{size:18}),disabled:""===M,sx:{paddingRight:12},children:""!==M?"Secure ".concat(M," Connection"):"Secure Connection"})]}),(0,i.jsx)(k.Z,{label:"My Miners",children:(0,i.jsxs)("table",{className:e.NFTTable,children:[(0,i.jsx)("thead",{className:e.thead,children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:e.th,children:"Miner Name"},"1"),(0,i.jsx)("th",{className:e.th,children:"NFT Status"},"2"),(0,i.jsx)("th",{className:e.th,children:"NFT ID"},"3"),(0,i.jsx)("th",{className:"".concat(e.th," ").concat(e.btn_th),children:"\xa0\xa0"},"4")]})}),(0,i.jsx)("tbody",{children:0==E.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:4,rowSpan:1,style:{textAlign:"center"},children:"No miners currently assigned."})},0):E.map((function(n,r){return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:e.center,children:n.Miner},"1"),(0,i.jsx)("td",{className:"".concat(e.green," ").concat(e.center),children:n.Connection},"2"),(0,i.jsx)("td",{className:"".concat(e.green," ").concat(e.center),children:(0,i.jsx)("div",{children:n.NFT})},"3"),(0,i.jsx)("td",{children:(0,i.jsx)("div",{children:"Assigned"===n.Connection&&(0,i.jsx)(u.z,{onClick:function(){return function(e){var n=function(){c.$().post("".concat(B,"/api/nft_auth/remove"),{address:t.currentNetwork.account,nft_id:e}).then((function(e){"success"===e.data.status?(x().fire({title:"Success",html:"<p>Connection Removed!</p>",icon:"success"}),O()):x().fire({title:"Error",html:"<p>Errors Occured while removing connection.</p>",icon:"error"})})).catch((function(e){x().fire({title:"Error",html:"<p>Errors Occured while removing connection.</p>",icon:"error"})}))};c.check_auth((function(){n()}),(function(){x().fire({title:"Error",html:"<p>You need to login to secure miner connection.</p>",icon:"error",showCancelButton:!0}).then((function(e){e.isConfirmed&&c.login((function(){n()}),(function(){x().fire({title:"Error",html:"<p>Errors Occured while login.</p>",icon:"error"})}))})).catch((function(){x().fire({title:"Info",html:"<p>Securing Miner Connection has been failed.</p>",icon:"info"})}))}))}(n.NFT)},className:e.button,size:"xs",children:"Remove Miner"})})})]},r)}))})]})}),(0,i.jsx)(F,{}),(0,i.jsx)(R,{})]})}))},44868:function(e,n,t){t.d(n,{Cm:function(){return o},Hk:function(){return l},MZ:function(){return s},SF:function(){return i},WJ:function(){return d},mr:function(){return u},t3:function(){return a}});var r=t(59411),c=t(33331).m.TOKEN_UNIT;function o(e){return e.substring(0,6)+"..."+e.substring(e.length-4)}function i(e){return parseInt((e/(c/BigInt(1e4))).toString())/1e4}function a(e){var n=new Date(3600*e*1e3),t=new Date(3600*(e+1)*1e3);new Date;return n.toLocaleTimeString()+" - "+t.toLocaleTimeString()}function s(){return o(r.Kt)}function l(e){return new Date(1e3*e).toLocaleString()}function u(e){for(var n=[1,60,3600,86400],t=["s","m","h","d"],r=[],c=n.length-1;c>=0;c--)r[c]=Math.floor(e/n[c]),e-=r[c]*n[c];for(var o=0,i="",a=n.length-1;a>=0&&!(r[a]>0&&(i+="".concat(r[a]).concat(t[a]),2==++o));a--);return""==i&&(i="0s"),i}function d(e){return e/100+"%"}}}]);