"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[322],{1686:function(n,e,t){t.d(e,{Z:function(){return i}});var r=t(85893),o=(0,t(58067).k)((function(n){return{root:{display:"flex",flexDirection:"column",height:"100%"},header:{backgroundColor:"dark"==n.colorScheme?"#0887BF":"#26BCFF",border:"0px",borderRadius:"6px",color:"white",alignItems:"center",justifyContent:"center",display:"flex",fontWeight:"bold",zIndex:100,position:"relative",height:"36px"},body:{marginTop:"-8px",backgroundColor:"dark"===n.colorScheme?"black":"#DBDBDB",borderWidth:"0px",color:"black",alignItems:"center",justifyContent:"center",display:"flex",flexDirection:"column",padding:"8px",paddingTop:"18px",borderRadius:"6px",flexGrow:1},secondMargin:{marginTop:"5px"}}}));function i(n){var e=n.label,t=n.children,i=n.bodyClass,c=void 0===i?"":i,a=o().classes;return(0,r.jsxs)("div",{className:a.root,children:[(0,r.jsx)("div",{className:a.header,children:(0,r.jsx)("div",{children:e})}),(0,r.jsx)("div",{className:"".concat(a.body," ").concat(c),children:t})]})}},75999:function(n,e,t){t.d(e,{Z:function(){return g}});var r=t(14924),o=t(85893),i=(t(67294),t(58067)),c=t(68940),a=t(76867),s=t(5074),l=t(51666),u=t(71217);function d(n){var e=n.className;return(0,o.jsxs)("div",{className:e,children:["Welcome to the Elumicate Mining Portal!",(0,o.jsx)("br",{}),"Please login and connect to Metamask to access the site."]})}var h="@media (max-width: 755px)",f=(0,i.k)((function(n){return{wrapper:{position:"relative",boxSizing:"border-box",backgroundColor:"dark"===n.colorScheme?n.colors.dark[8]:"#ffffffdb",boxShadow:"dark"===n.colorScheme?"0px 0px 6px 6px #00000030":"0px 0px 6px 6px #ffffffdb"},inner:{position:"relative",paddingLeft:0,paddingRight:0,maxWidth:"none"},title:(0,r.Z)({fontFamily:"Proxima-Nova, ".concat(n.fontFamily),fontSize:62,fontWeight:900,lineHeight:1.1,margin:0,padding:0,color:"dark"===n.colorScheme?n.white:n.black},h,{fontSize:42,lineHeight:1.2}),description:(0,r.Z)({marginTop:n.spacing.xl,fontSize:24},h,{fontSize:18}),controls:(0,r.Z)({marginTop:2*n.spacing.xl},h,{marginTop:n.spacing.xl}),control:(0,r.Z)({height:54,paddingLeft:38,paddingRight:38},h,{height:54,paddingLeft:18,paddingRight:18,flex:1}),githubControl:{borderWidth:2,borderColor:"dark"===n.colorScheme?"transparent":n.colors.dark[9],backgroundColor:"dark"===n.colorScheme?n.colors.dark[5]:"transparent","&:hover":{backgroundColor:"".concat("dark"===n.colorScheme?n.colors.dark[6]:n.colors.gray[0]," !important")}},paddingLeft:{paddingLeft:"36px"},loginMsgDiv:{width:"100%",height:"100%",fontSize:"2em",fontWeight:"bold",textAlign:"center"}}})),p=(c.O,(0,u.Pi)((function(n){var e=n.children,t=f().classes,r=(0,l.o)().god,i=((0,u.fv)((function(){return{showConnecter:function(){r.setShowConnecter(!0)},showWalletInfo:function(){r.currentNetwork.walletInfo.visible=!0},currentAvatar:1}})),(0,o.jsx)(u.Qj,{children:function(){return(0,o.jsx)(s.C,{children:(0,o.jsx)("div",{className:t.wrapper,children:(0,o.jsx)(a.W,{className:t.inner,children:r.currentNetwork.account?e:(0,o.jsx)(d,{className:t.loginMsgDiv})})})})}}));return(0,o.jsx)(o.Fragment,{children:i})})));p.displayName="HeroTitle";var g=p},35322:function(n,e,t){t.r(e);var r=t(47568),o=t(34051),i=t.n(o),c=t(85893),a=t(75999),s=t(58067),l=t(91142),u=t(88852),d=t(55910),h=t(33331),f=t(51666),p=t(9669),g=t.n(p),m=t(86455),x=t.n(m),b=t(31037),N=t(59411),k=t(67294),v=t(1686),w=t(71217),j=t(55649),C=(t(18699).getWindow().ethereum,h.m.BACKEND_URL),S=(0,s.k)((function(n){return{progressBar:{"&:not(:first-of-type)":{borderLeft:"3px solid ".concat("dark"===n.colorScheme?n.colors.dark[7]:n.white)}},NFTTable:{background:"white",color:"black",width:"100%"},green:{color:"green"},center:{textAlign:"center"},button:{marginLeft:10,marginRight:10},thead:{borderBottom:"1px solid black"},th:{borderBottom:"1px solid black"},btn_th:{width:110}}}));e.default=(0,w.Pi)((function(){var n=S().classes,e=(0,f.o)(),t=e.god,o=e.auth,s=e.nft,p=(0,k.useState)(!1),m=p[0],w=p[1],y=(0,k.useState)([]),T=(y[0],y[1]),E=(0,k.useState)([]),F=E[0],_=E[1],M=(0,k.useState)(""),I=M[0],B=M[1],R=(0,k.useState)(null),D=R[0],L=R[1];(0,k.useEffect)((function(){s.refresh()}),[t.currentNetwork.account]);var Z=function(){var n="".concat(h.m.DEVICE_URL,"/get_status");g().get(n).then((function(n){var e=n.data;"an error has occured"==e.message?B(""):o.$().post("".concat(C,"/api/nft_auth/verifySignature"),{signature:e.signature}).then((function(n){"OK"===n.data.status?B(""):B(e.miner)})).catch((function(n){B(e.miner)}))})).catch((function(n){B("")}))},z=function(){s.getNFTLists().then(function(){var n=(0,r.Z)(i().mark((function n(e){var t,r,c,a,s,l;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=e,r=[],c=0;case 3:if(!(c<t.length)){n.next=19;break}return a=t[c].toString(),n.prev=5,n.next=8,o.$().post("".concat(C,"/api/nft_auth/status"),{nft_id:a});case 8:s=n.sent,l=s.data.data,r.push({NFT:l.nft_id,Miner:l.miner?l.miner:"Not set",Connection:l.session?"Assigned":"Not assigned"}),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),r.push({NFT:parseInt(a),Miner:"Not assigned",Connection:"Not assigned"});case 16:c++,n.next=3;break;case 19:_(r);case 20:case"end":return n.stop()}}),n,null,[[5,13]])})));return function(e){return n.apply(this,arguments)}}()).catch((function(n){T([])}))},W=function(){z(),Z()};(0,k.useEffect)((function(){Z()}),[t.currentNetwork.account]),(0,k.useEffect)((function(){var n=setInterval((function(){Z()}),2e3);return function(){clearInterval(n)}}),[]),(0,k.useEffect)((function(){z()}),[t.currentNetwork.account]);var A=function(){var n=(0,r.Z)(i().mark((function n(){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=N.Kt,n.prev=1,n.next=4,t.currentNetwork.execContract({address:e,abi:b.Mt,method:"balanceOf",params:[t.currentNetwork.account]});case 4:if(!(n.sent[0]>0)){n.next=7;break}return n.abrupt("return",!0);case 7:return n.abrupt("return",!1);case 10:return n.prev=10,n.t0=n.catch(1),n.abrupt("return",!1);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(){return n.apply(this,arguments)}}();(0,k.useEffect)((function(){A().then((function(n){w(!0)})).catch((function(n){w(!1)}))}),[t.currentNetwork.account]);return s.loading?(0,c.jsx)(a.Z,{children:(0,c.jsx)(l.a,{})}):(0,c.jsxs)(a.Z,{children:[(0,c.jsxs)("div",{style:{display:"flex"},children:[(0,c.jsx)(j.Ph,{placeholder:s.infoList.length>0?"Choose NFT to Assign":"No NFTs to assign",data:F.filter((function(n){return"Not assigned"==n.Connection})).map((function(n,e){return{value:n.NFT.toString(),label:"NFT "+n.NFT.toString(),group:"Testnet Miner"}})),style:{marginRight:10},onChange:L}),(0,c.jsx)(u.z,{style:{marginBottom:"10px"},onClick:function(){if(!1!==m)if(null!=D){var n=function(){o.$().post("".concat(C,"/api/nft_auth/create"),{address:t.currentNetwork.account,nft_id:D,miner:I}).then((function(n){if("success"==n.data.status){x().fire({title:"Success",html:"<p>Secure Miner Connection Success</p>",icon:"success"}),W();var e="".concat(h.m.DEVICE_URL,"/set_signature"),r=t.currentNetwork.account,o=D,i=n.data.camera.link,c="P"+(n.data.camera.tableid+1)+n.data.camera.id;g().post(e,{signature:n.data.session,nftID:o,wallet:r,link:i,location_id:c},{})}else x().fire({title:"Error",html:"<p>No assignable miners</p>",icon:"error"})})).catch((function(n){x().fire({title:"Error",html:"<p>Errors occured while securing miner connection</p>",icon:"error"})}))};o.check_auth((function(){n()}),(function(){x().fire({title:"Error",html:"<p>You need to login to secure miner connection.</p>",icon:"error",showCancelButton:!0}).then((function(e){e.isConfirmed&&o.login((function(){n()}),(function(){x().fire({title:"Error",html:"<p>Errors Occured while login.</p>",icon:"error"})}))})).catch((function(){x().fire({title:"Info",html:"<p>Securing Miner Connection has been failed.</p>",icon:"info"})}))}))}else x().fire("Info","<p>You need to choose an NFT to secure your Mining Connection.</p>","info");else x().fire("Error",'<p>You do not have an NFT to secure your Mining Connection.</p>\n                 <p>Please obtain a mining NFT and try again.</p>\n                 <p><a href="/nft/">Buy NFT</a></p>',"warning")},rightIcon:(0,c.jsx)(d.Z,{size:18}),disabled:""===I,sx:{paddingRight:12},children:""!==I?"Secure ".concat(I," Connection"):"Secure Connection"})]}),(0,c.jsx)(v.Z,{label:"My Miners",children:(0,c.jsxs)("table",{className:n.NFTTable,children:[(0,c.jsx)("thead",{className:n.thead,children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{className:n.th,children:"Miner Name"},"1"),(0,c.jsx)("th",{className:n.th,children:"NFT Status"},"2"),(0,c.jsx)("th",{className:n.th,children:"NFT ID"},"3"),(0,c.jsx)("th",{className:"".concat(n.th," ").concat(n.btn_th),children:"\xa0\xa0"},"4")]})}),(0,c.jsx)("tbody",{children:0==F.length?(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:4,rowSpan:1,style:{textAlign:"center"},children:"No miners currently assigned."})},0):F.map((function(e,r){return(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:n.center,children:e.Miner},"1"),(0,c.jsx)("td",{className:"".concat(n.green," ").concat(n.center),children:e.Connection},"2"),(0,c.jsx)("td",{className:"".concat(n.green," ").concat(n.center),children:(0,c.jsx)("div",{children:e.NFT})},"3"),(0,c.jsx)("td",{children:(0,c.jsx)("div",{children:"Assigned"===e.Connection&&(0,c.jsx)(u.z,{onClick:function(){return function(n){var e=function(){o.$().post("".concat(C,"/api/nft_auth/remove"),{address:t.currentNetwork.account,nft_id:n}).then((function(n){"success"===n.data.status?(x().fire({title:"Success",html:"<p>Connection Removed!</p>",icon:"success"}),W()):x().fire({title:"Error",html:"<p>Errors Occured while removing connection.</p>",icon:"error"})})).catch((function(n){x().fire({title:"Error",html:"<p>Errors Occured while removing connection.</p>",icon:"error"})}))};o.check_auth((function(){e()}),(function(){x().fire({title:"Error",html:"<p>You need to login to secure miner connection.</p>",icon:"error",showCancelButton:!0}).then((function(n){n.isConfirmed&&o.login((function(){e()}),(function(){x().fire({title:"Error",html:"<p>Errors Occured while login.</p>",icon:"error"})}))})).catch((function(){x().fire({title:"Info",html:"<p>Securing Miner Connection has been failed.</p>",icon:"info"})}))}))}(e.NFT)},className:n.button,size:"xs",children:"Remove Miner"})})})]},r)}))})]})})]})}))}}]);