(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[503],{98229:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/swap",function(){return t(76013)}])},76013:function(e,n,t){"use strict";t.r(n),t.d(n,{Home:function(){return O},default:function(){return R}});var a,r=t(47568),u=t(34051),s=t.n(u),o=t(85893),i=t(67294),c=t(71217),p=t(88852),l=t(26242),d=t(95977),f=t(34934),w=t(4111),h=t(51438),v=t(52951),g=t(28668),y=t(26626),m=t(70655),b=t(94074),_=t(4869),x=function e(){(0,h.Z)(this,e)},k=function e(){(0,h.Z)(this,e)};!function(e){e.Price="price",e.MarketCap="market_cap",e.Balance="balance"}(a||(a={}));var Z=function e(){(0,h.Z)(this,e)},C=t(68949),E=t(68325),Q=t(74922),A=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,h.Z)(this,e),this.loading=new E.mZ,this.value=null,this.autoAlert=!0,this.context=void 0,Object.assign(this,n),(0,C.ky)(this)}return e.prototype.call=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=this;return(0,r.Z)(s().mark((function e(){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.loading.setValue(!0),e.next=4,a.function.apply(a.context,n);case 4:return t=e.sent,a.value=t,e.abrupt("return",t);case 9:if(e.prev=9,e.t0=e.catch(0),console.log(e.t0),!a.autoAlert){e.next=16;break}(0,Q.c0)({title:"Error",message:(null===(r=e.t0.data)||void 0===r?void 0:r.message)||e.t0.message,color:"red"}),e.next=17;break;case 16:throw e.t0;case 17:return e.prev=17,a.loading.setValue(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,9,17,20]])})))()},e}(),B=t(20179),T=function(e){(0,g.Z)(t,e);var n=(0,y.Z)(t);function t(){return(0,h.Z)(this,t),n.apply(this,arguments)}return t.prototype.test=function(){console.log("test")},(0,v.Z)(t,[{key:"logo",get:function(){return"https://iotexproject.iotex.io/iotex-token-metadata/master/images/".concat(this.address,".png")}}]),t}(k);(0,m.__decorate)([(0,b.C)(),(0,m.__metadata)("design:type",Function),(0,m.__metadata)("design:paramtypes",[])],T.prototype,"logo",null);var j=function(e){(0,g.Z)(t,e);var n=(0,y.Z)(t);function t(){var e;return(0,h.Z)(this,t),(e=n.apply(this,arguments)).foo=123,e.path=[],e}return(0,v.Z)(t,[{key:"bar",get:function(){return 456}}]),t}(Z);(0,m.__decorate)([(0,_.D)((function(){return T})),(0,m.__metadata)("design:type",Array)],j.prototype,"path",void 0),(0,m.__decorate)([(0,b.C)(),(0,m.__metadata)("design:type",Function),(0,m.__metadata)("design:paramtypes",[])],j.prototype,"bar",null);var S=function(e){(0,g.Z)(t,e);var n=(0,y.Z)(t);function t(){var e;(0,h.Z)(this,t),e=n.apply(this,arguments);var a=(0,w.Z)(e);return e._swap=new A({function:(0,r.Z)(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.swap,t=n.data,r=n.value,e.next=3,B._.c.sendTx({address:a.address,chainId:a.chainId,data:t,value:r}).finally((function(){a.swap=null,console.log(a.swap)}));case 3:case"end":return e.stop()}}),e)})))}),e.swap=null,e}return t}(x);(0,m.__decorate)([(0,_.D)((function(){return j})),(0,m.__metadata)("design:type","undefined"===typeof j?Object:j)],S.prototype,"swap",void 0);var I=t(5074),N=t(41289),O=(0,c.Pi)((function(){var e,n=(0,c.fv)((function(){return{swapQuery:new A({function:(0,r.Z)(s().mark((function e(){var t,a,r,u,o,i=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.buyAmount,r=void 0===a?"1000000000000000000":a,e.next=3,(0,d.f4)("query")({UniswapRouter:[{calls:[{address:"0x147CdAe2BF7e809b9789aD0765899c06B361C5cE",chainId:4689}]},{address:!0,chainId:!0,swap:[{args:{sellToken:"IOTX",buyToken:"0xb8744ae4032be5e5ef9fab94ee9c3bf38d5d2ae0",buyAmount:r,recipient:"0x2AcB8663B18d8c8180783C18b88D60b86de26dF2"}},{amount:!0,data:!0,router:!0,value:!0,path:{address:!0,symbol:!0,decimals:!0,totalSupply:!0}}]}]});case 3:if(u=e.sent,!n.swapQuery.value){e.next=6;break}return e.abrupt("return",(0,f.gS)(n.swapQuery.value,u.UniswapRouter[0]));case 6:return o=(0,f.yE)(S,u.UniswapRouter[0]),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})))}),handleSwap:function(){return(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.swapQuery.value.swap){e.next=3;break}return e.next=3,n.swapQuery.call();case 3:n.swapQuery.value._swap.call();case 4:case"end":return e.stop()}}),e)})))()}}}));return(0,i.useEffect)((function(){n.swapQuery.call()}),[]),(0,o.jsxs)(I.C,{children:[(0,o.jsx)(N.p1,{language:"tsx",children:"\n\n// smartgraph.ts\nimport { SmartGraph } from '@smartgraph/core';\nexport const smartGraph = new SmartGraph({\n  plugins: [plugins.NetworkPlugin(), plugins.ERC20Extension(), plugins.LpTokenExtension(), UniswapPlugin()]\n});\n...\n\n//page.tsx\nimport {rpc} from \"@/src/lib/smartgraph/gql\"\n\nconst swapQuery = await rpc('query')({\n  UniswapRouter: [ { calls: [{ address: '0x147CdAe2BF7e809b9789aD0765899c06B361C5cE', chainId: 4689 }] }, {\n      address: true,\n      chainId: true,\n      swap: [{args: {sellToken: 'IOTX',buyToken: '0xb8744ae4032be5e5ef9fab94ee9c3bf38d5d2ae0', buyAmount: 1000000000000000000,recipient: '0x2AcB8663B18d8c8180783C18b88D60b86de26dF2'}}, {\n          amount: true,\n          data: true,\n          router: true,\n          value: true,\n          path: {\n            address: true,\n            symbol: true,\n            decimals: true,\n            totalSupply: true\n          }\n        }\n      ]\n    }\n  ]\n});\nreturn plainToInstance(UniswapRouter, data.UniswapRouter[0]);\n\n<Button loading={store.swapQuery.loading.value} onClick={() => store.swapQuery.value._swap.call()}>\n  Swap\n</Button>\n\n"}),(0,o.jsx)(p.z,{loading:n.swapQuery.loading.value,onClick:function(){return n.handleSwap()},children:"Swap"}),(0,o.jsxs)("pre",{style:{position:"relative",minHeight:"200px"},children:[(0,o.jsx)(l.f,{visible:n.swapQuery.loading.value}),(0,o.jsx)(N.p1,{language:"json",children:JSON.stringify((null===(e=n.swapQuery.value)||void 0===e?void 0:e.swap)||{},null,2)})]})]})})),R=O}},function(e){e.O(0,[89,461,739,774,888,179],(function(){return n=98229,e(e.s=n);var n}));var n=e.O();_N_E=n}]);